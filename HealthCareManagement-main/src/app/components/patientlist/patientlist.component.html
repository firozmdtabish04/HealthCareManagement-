<app-header></app-header>

<div class="panel panel-primary">

  <div class="panel-heading">

    <h2 class="heading-text">
      Patient List
    </h2>

  </div>


  <div class="panel-body">

    <table class="table table-bordered">

      <thead>
        <tr>
          <th>Identity</th>
          <th>Patient ID</th>
          <th>Name</th>
          <th>Age</th>
          <th>Slot</th>
          <th>Date</th>
          <th>Problem</th>
          <th>Approval</th>
          <th>Admission</th>
        </tr>
      </thead>


      <tbody>

        <tr *ngFor="let patient of patients | async">

          <!-- Identity -->
          <td>

            <img
              *ngIf="patient.gender === 'Male' || patient.gender === 'male'"
              class="user-img"
              src="assets/img/maleuser.png"
              alt="Male Patient"
            />

            <img
              *ngIf="patient.gender === 'Female' || patient.gender === 'female'"
              class="user-img"
              src="assets/img/femaleuser.png"
              alt="Female Patient"
            />

          </td>


          <!-- Patient ID -->
          <td>
            <div class="date-cover">
              {{ patient.patientid }}
            </div>
          </td>


          <!-- Name -->
          <td>{{ patient.patientname }}</td>


          <!-- Age -->
          <td>{{ patient.age }} years</td>


          <!-- Slot -->
          <td>

            <div *ngIf="loggedUser === 'admin@gmail.com'">

              <div class="slotcover">
                {{ patient.slot }}
              </div>

            </div>


            <div *ngFor="let slot of slots | async">

              <div
                *ngIf="
                  patient.slot === 'AM slot' &&
                  slot.amstatus === 'booked' &&
                  patient.date === slot.date
                "
              >
                <div class="slotcover">
                  {{ slot.amslot }}
                </div>
              </div>


              <div
                *ngIf="
                  patient.slot === 'Noon slot' &&
                  slot.noonstatus === 'booked' &&
                  patient.date === slot.date
                "
              >
                <div class="slotcover">
                  {{ slot.noonslot }}
                </div>
              </div>


              <div
                *ngIf="
                  patient.slot === 'PM slot' &&
                  slot.pmstatus === 'booked' &&
                  patient.date === slot.date
                "
              >
                <div class="slotcover">
                  {{ slot.pmslot }}
                </div>
              </div>

            </div>

          </td>


          <!-- Date -->
          <td>
            <div class="date-cover">
              {{ patient.date }}
            </div>
          </td>


          <!-- Problem -->
          <td>{{ patient.problem }}</td>


          <!-- Approval -->
          <td>

            <div *ngIf="currRole === 'admin' || currRole === 'ADMIN'">

              <div
                *ngIf="patient.appointmentstatus === 'accept'"
                class="accepted"
              >
                Accepted
              </div>

              <div
                *ngIf="patient.appointmentstatus === 'false'"
                class="pending"
              >
                Pending
              </div>

              <div
                *ngIf="patient.appointmentstatus === 'reject'"
                class="rejected"
              >
                Rejected
              </div>

            </div>


            <!-- Doctor controls -->
            <div *ngIf="currRole === 'doctor' || currRole === 'DOCTOR'">

              <button
                *ngIf="patient.appointmentstatus === 'false'"
                (click)="acceptRequest(patient.slot)"
                class="accepted"
              >
                Accept
              </button>

              <button
                *ngIf="patient.appointmentstatus === 'false'"
                (click)="rejectRequest(patient.slot)"
                class="rejected"
              >
                Reject
              </button>

              <div
                *ngIf="patient.appointmentstatus === 'accept'"
                class="accepted"
              >
                Accepted
              </div>

              <div
                *ngIf="patient.appointmentstatus === 'reject'"
                class="rejected"
              >
                Rejected
              </div>

            </div>

          </td>


          <!-- Admission -->
          <td>

            <div
              *ngIf="patient.admissionstatus === 'accept'"
              class="accepted"
            >
              Admitted
            </div>

            <div
              *ngIf="patient.admissionstatus === 'false'"
              class="pending"
            >
              Pending
            </div>

            <div
              *ngIf="patient.admissionstatus === 'reject'"
              class="rejected"
            >
              Not Admitted
            </div>

          </td>

        </tr>

      </tbody>

    </table>

  </div>

</div>

<app-footer></app-footer>
